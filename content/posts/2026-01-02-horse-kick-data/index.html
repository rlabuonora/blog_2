---
title: 'Muerte por patada de caballo prusiano'
author: ''
date: '2023-01-02'
slug: []
categories: []
tags: []
images: []
sidebar_image: "Ladislaus_Bortkiewicz.jpg"
sidebar_caption: "Ladislaus von Bortkeiwicz"
draft: false
header-includes:
  - |
    <style>
      @import url("https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=IBM+Plex+Sans:wght@400;600;700&display=swap");
      :root {
        --title-font: "IBM Plex Sans", sans-serif;
        --body-font: "EB Garamond", serif;
      }
      body, p, li, blockquote, .post-content, #container, #container main {
        font-family: var(--body-font) !important;
      }
      body {
        font-size: 1.5rem;
      }
      #container main article,
      #container main article p,
      #container main article li {
        font-size: 1.5rem;
      }
      a {
        color: #2F3E4E;
        text-decoration: none;
      }
      #container main article a {
        text-decoration: underline;
      }
      table {
        background: #F1EFEA;
        border: 1px solid #CFCFCF;
        color: inherit;
      }
      table th,
      table td {
        border-color: #CFCFCF;
      }
      h1, h2, h3, h4, h5, h6, .post-title, .entry-title, #container header h1 {
        font-family: var(--title-font) !important;
      }
      #container header h1,
      h1,
      .post-title,
      .entry-title {
        font-size: 2rem;
        text-align: center;
      }
      #container nav ul li a {
        font-size: 1.05rem;
      }
      #container header h1 {
        text-align: left;
      }
      .post-title + p,
      .entry-title + p,
      #container main h1 + p {
        margin-top: 0.2rem;
      }
      #container main article > h1 {
        margin-bottom: 0.2rem;
      }
      #container main article aside {
        margin: 0;
      }
      #container main article > p:first-of-type {
        margin-top: 0;
      }
      .post-sidebar .sidebar-figure {
        margin: 0;
      }
      #container main article > pre {
        background-color: transparent;
        box-shadow: none;
      }
      #container main article pre.r,
      #container main article .highlight pre {
        background-color: #f1f1f1;
      }
    </style>
---

<style>
  @import url("https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=IBM+Plex+Sans:wght@400;600;700&display=swap");
  :root {
    --title-font: "IBM Plex Sans", sans-serif;
    --body-font: "EB Garamond", serif;
  }
  body, p, li, blockquote, .post-content, #container, #container main {
    font-family: var(--body-font) !important;
  }
  body {
    font-size: 1.5rem;
  }
  #container main article,
  #container main article p,
  #container main article li {
    font-size: 1.5rem;
  }
  a {
    color: #2F3E4E;
    text-decoration: none;
  }
  #container main article a {
    text-decoration: underline;
  }
  table {
    background: #F1EFEA;
    border: 1px solid #CFCFCF;
    color: inherit;
  }
  table th,
  table td {
    border-color: #CFCFCF;
  }
  h1, h2, h3, h4, h5, h6, .post-title, .entry-title, #container header h1 {
    font-family: var(--title-font) !important;
  }
  #container header h1,
  h1,
  .post-title,
  .entry-title {
    font-size: 2rem;
    text-align: center;
  }
  #container nav ul li a {
    font-size: 1.05rem;
  }
  #container header h1 {
    text-align: left;
  }
  .post-title + p,
  .entry-title + p,
  #container main h1 + p {
    margin-top: 0.2rem;
  }
  #container main article > h1 {
    margin-bottom: 0.2rem;
  }
  #container main article aside {
    margin: 0;
  }
  #container main article > p:first-of-type {
    margin-top: 0;
  }
  .post-sidebar .sidebar-figure {
    margin: 0;
  }
  #container main article > pre {
    background-color: transparent;
    box-shadow: none;
  }
  #container main article pre.r,
  #container main article .highlight pre {
    background-color: #f1f1f1;
  }
</style>


<p>En la época de la guerra Franco-Prusiana, los prusianos llevaban registros detallados de la muerte de los soldados. Cada vez que un caballo mataba a a un soldado de una patada, anotaban:</p>
<p><img src="tabla.png" /></p>
<p>La tabla anterior muestra los datos de 20 años para 14 cuerpos. Cada combinación de año-cuerpo representa una observación. No pases rápido esta parte porque es importante para entender lo que viene después.</p>
<p>Cada año cuerpo es una <em>unidad de exposición</em> al riesgo de que un caballo te pegue una patada. El riesgo no lo corre el soldado, ni en cuerpo, ni el año. El riesgo lo corre el año-cuerpo. Los datos estan disponibles en un paquete de R:</p>
<pre><code>## # A tibble: 6 × 3
##   corps  year  kick
##   &lt;fct&gt; &lt;int&gt; &lt;int&gt;
## 1 G      1875     0
## 2 I      1875     0
## 3 II     1875     0
## 4 III    1875     0
## 5 IV     1875     0
## 6 V      1875     0</code></pre>
<p>Los datos nos dicen cuantas veces ocurrió el evento para 240 unidades de exposición al riesgo. La mayor parte de las veces, el evento no ocurre. Entre 1875 y 1894, los datos tienen hubo 196 muertos por patadas de caballo.</p>
<p>Como el evento es bastante raro, en la mayor parte de las unidades de exposición al riesgo, el evento no ocurrió. En el peor escenario, un cuerpo perdía 4 soldados en un año por esta causa (cuerpos XIV en el 80 y el 82):</p>
<pre class="r"><code>patadas |&gt; 
  filter(kick==4)</code></pre>
<pre><code>## # A tibble: 2 × 3
##   corps  year  kick
##   &lt;fct&gt; &lt;int&gt; &lt;int&gt;
## 1 XIV    1880     4
## 2 XIV    1882     4</code></pre>
<p>Si miramos toda la distribución vemos que la cantidad de unidades decrece rápidamente con la cantidad de ocurrencias del evento: la mayor parte de las veces la cantidad es 0, algunos tienen 1 muerto, pocos 2, muy pocos 3 y casi ninguno 4:</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>En promedio, las unidades registran el evento 0.7 veces. O sea, para cada año y para cada cuerpo, el promedio de soldados muertos es 0.7.</p>
<p><a href="https://en.wikipedia.org/wiki/Ladislaus_Bortkiewicz">Ladislaus von Bortkeiwicz</a> descubrió que estos datos siguen una distribución Poisson. Esta distribución sirve para modelar eventos raros que suceden en forma independiente con una tasa de ocurrencia (<span class="math inline">\(\lambda\)</span>) constante.</p>
<p>Si <span class="math inline">\(X\)</span> sigue una distribución Poisson, <span class="math inline">\(\lambda\)</span> es la esperanza de ocurrencia del evento por <em>unidad de exposición</em>. Por eso te dije que prestaras atención al principio. El estimador de <span class="math inline">\(\lambda\)</span> es el promedio de ocurrencias del evento para las unidades de exposición: 0.7. Una vez que tenemos un estimador de <span class="math inline">\(\lambda\)</span>, podemos calcular cuantas veces esperamos ver 0, 1, 2, 3 y 4 muertos usando la función de densidad:</p>
<p><span class="math display">\[ P(X=x) = \frac{e^{-\lambda}  \lambda^x}{x!} \]</span></p>
<p>No tengo idea de cómo se calculaba esto en Europa del Este a fines del siglo XIX, pero en R es fácil con la función <code>dpois</code>:</p>
<pre class="r"><code>lambda &lt;- mean(patadas$kick)

cuentas &lt;- cuentas |&gt; 
  mutate(pred=dpois(muertes, lambda) * sum(n)) |&gt; 
  tidyr::pivot_longer(-muertes)

cuentas |&gt; 
  ggplot(aes(muertes, value, fill=name)) + 
  geom_col(position=&quot;dodge&quot;) +
  scale_fill_manual(&quot;&quot;,
    values = c(&quot;#1E1C1A&quot;, &quot;#6E6B68&quot;)) +
  labs(x=&quot;Muertes por patada&quot;, y=&quot;N&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>

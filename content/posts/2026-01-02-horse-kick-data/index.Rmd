---
title: 'Muerte por patada de caballo prusiano'
author: ''
date: '2026-01-10'
slug: []
categories: []
tags: []
images: []
sidebar_image: "Ladislaus_Bortkiewicz.jpg"
sidebar_caption: "Ladislaus von Bortkeiwicz"
draft: false
header-includes:
  - |
    <style>
      @import url("https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=IBM+Plex+Sans:wght@400;600;700&display=swap");
      :root {
        --title-font: "IBM Plex Sans", sans-serif;
        --body-font: "EB Garamond", serif;
      }
      body, p, li, blockquote, .post-content, #container, #container main {
        font-family: var(--body-font) !important;
      }
      body {
        font-size: 1.5rem;
      }
      #container main article,
      #container main article p,
      #container main article li {
        font-size: 1.5rem;
      }
      a {
        color: #2F3E4E;
        text-decoration: none;
      }
      #container main article a {
        text-decoration: underline;
      }
      table {
        background: #F1EFEA;
        border: 1px solid #CFCFCF;
        color: inherit;
      }
      table th,
      table td {
        border-color: #CFCFCF;
      }
      h1, h2, h3, h4, h5, h6, .post-title, .entry-title, #container header h1 {
        font-family: var(--title-font) !important;
      }
      #container header h1,
      h1,
      .post-title,
      .entry-title {
        font-size: 2rem;
        text-align: center;
      }
      #container nav ul li a {
        font-size: 1.05rem;
      }
      #container header h1 {
        text-align: left;
      }
      .post-title + p,
      .entry-title + p,
      #container main h1 + p {
        margin-top: 0.2rem;
      }
      #container main article > h1 {
        margin-bottom: 0.2rem;
      }
      #container main article aside {
        margin: 0;
      }
      #container main article > p:first-of-type {
        margin-top: 0;
      }
      .post-sidebar .sidebar-figure {
        margin: 0;
      }
      #container main article > pre {
        background-color: transparent;
        box-shadow: none;
      }
      #container main article pre.r,
      #container main article .highlight pre {
        background-color: #f1f1f1;
      }
    </style>
---
```{r warning=FALSE, message=FALSE, echo=FALSE}
suppressPackageStartupMessages({
  library(dplyr)
  library(tibble)
  library(ggplot2)
  library(showtext)
})

font_add_google(name = "EB Garamond", family = "EB Garamond")
font_add_google(name = "IBM Plex Sans", family = "IBM Plex Sans")
showtext_auto()
theme_set(
  theme_minimal(base_family = "EB Garamond") +
    theme(
      plot.title = element_text(family = "IBM Plex Sans", color = "#2B2B2B"),
      plot.subtitle = element_text(family = "IBM Plex Sans", color = "#2B2B2B"),
      axis.title = element_text(size = 16),
      axis.text = element_text(size = 14),
      legend.title = element_text(size = 14),
      legend.text = element_text(size = 13)
    )
)
```


En la época de la guerra Franco-Prusiana, los prusianos llevaban registros detallados de la muerte de los soldados. Cada vez que un caballo mataba a a un soldado de una patada, anotaban:

![](./tabla.png)

La tabla anterior muestra los datos de 20 años para 14 cuerpos. Cada combinación de año-cuerpo representa una observación. No pases rápido esta parte porque es importante para entender lo que viene después. 

Cada año cuerpo es una _unidad de exposición_ al riesgo de que un caballo te pegue una patada. El riesgo no lo corre el soldado, ni en cuerpo, ni el año. El riesgo lo corre el año-cuerpo. Los datos estan disponibles en un paquete de R:

```{r warning=FALSE, message=FALSE, echo=FALSE}


library(Horsekicks)

patadas <- hkdeaths |> 
  filter(between(year, 1875, 1894)) |> 
  select(corps, year, kick) |> 
  tibble::as_tibble()

head(patadas)
```

Los datos nos dicen cuantas veces ocurrió el evento para 240 unidades de exposición al riesgo. La mayor parte de las veces, el evento no ocurre. Entre 1875 y 1894, los datos tienen  hubo `r sum(patadas$kick)` muertos por patadas de caballo. 

Como el evento es bastante raro, en la mayor parte de las unidades de exposición al riesgo, el evento no ocurrió. En el peor escenario, un cuerpo perdía 4 soldados en un año por esta causa (cuerpos XIV en el 80 y el 82):

```{r}
patadas |> 
  filter(kick==4)
```
Si miramos toda la distribución vemos que la cantidad de unidades decrece rápidamente con la cantidad de ocurrencias del evento: la mayor parte de las veces la cantidad es 0, algunos tienen 1 muerto, pocos 2, muy pocos 3 y casi ninguno 4:

```{r message=FALSE, warning=FALSE, echo=FALSE}
cuentas <- patadas |> 
  group_by(year, corps) |> 
  summarise(muertes=(sum(kick))) |> 
  ungroup() |> 
  count(muertes)

cuentas |> 
  ggplot(aes(muertes, n)) +
  geom_col(fill = "#1E1C1A") +
  labs(x="Muertes por patada", y="N")

```

En promedio, las unidades registran el evento `r mean(patadas$kick)` veces. O sea, para cada año y para cada cuerpo, el promedio de soldados muertos es 0.7.

[Ladislaus von Bortkeiwicz](https://en.wikipedia.org/wiki/Ladislaus_Bortkiewicz) descubrió que estos datos siguen una distribución Poisson. Esta distribución sirve para modelar eventos raros que suceden en forma independiente con una tasa de ocurrencia ($\lambda$) constante.

Si $X$ sigue una distribución Poisson, $\lambda$ es la esperanza de ocurrencia del evento por _unidad de exposición_. Por eso te dije que prestaras atención al principio. El estimador de $\lambda$ es el promedio de ocurrencias del evento para las unidades de exposición: 0.7. Una vez que tenemos un estimador de $\lambda$, podemos calcular cuantas veces esperamos ver 0, 1, 2, 3 y 4 muertos usando la función de densidad:

$$ P(X=x) = \frac{e^{-\lambda}  \lambda^x}{x!} $$

No tengo idea de cómo se calculaba esto en Europa del Este a fines del siglo XIX, pero en R es fácil con la función `dpois`:

```{r}
lambda <- mean(patadas$kick)

cuentas <- cuentas |> 
  mutate(pred=dpois(muertes, lambda) * sum(n)) |> 
  tidyr::pivot_longer(-muertes)

cuentas |> 
  ggplot(aes(muertes, value, fill=name)) + 
  geom_col(position="dodge") +
  scale_fill_manual("",
    values = c("#1E1C1A", "#6E6B68")) +
  labs(x="Muertes por patada", y="N")
```
